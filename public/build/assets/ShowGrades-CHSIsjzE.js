import{r as x,d as f,x as D,c as i,o as n,a as t,i as _,l as L,t as d,F as h,f as k,n as w,W as A}from"./app-Bgi85lxd.js";import{S as v}from"./sweetalert2.esm.all-9Qm2jZ7z.js";const B={class:"overflow-x-auto px-4 py-6"},C={key:0},E={class:"mb-6"},O={key:0,class:"text-green-600 mt-2"},j={key:1,class:"text-red-600 mt-2"},I={class:"min-w-full border rounded shadow bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100"},P={class:"bg-gray-100 dark:bg-gray-800 text-sm font-semibold text-gray-800 dark:text-gray-100"},W={class:"px-4 py-2"},T={class:"px-4 py-2"},V={class:"px-4 py-2"},z={class:"px-4 py-2 font-semibold"},H={class:"px-4 py-2"},M={colspan:"100%",class:"text-center py-4 bg-gray-50 dark:bg-gray-800 text-gray-800 dark:text-gray-100"},U={key:1,class:"text-sm text-red-600 dark:text-red-400"},J={key:1},K={class:"min-w-full border rounded shadow bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100"},Q={class:"bg-gray-100 dark:bg-gray-800 text-sm font-semibold text-gray-800 dark:text-gray-100"},R={class:"px-4 py-2"},X={class:"px-4 py-2"},Y={class:"px-4 py-2"},Z={class:"px-4 py-2 font-semibold"},$={class:"px-4 py-2"},re={__name:"ShowGrades",props:{section:{type:Object,required:!0},course:{type:Object,required:!0},semester:{type:Object,required:!0},weights:{type:Array,required:!0},instructor:{type:Object,required:!0},studentsList:{type:Object,required:!0}},setup(S){const a=S,G=x({id:1}),u=f(()=>a.weights.reduce((e,r)=>e+(parseFloat(r.point)||0),0)),g=D({grades:[]}),p=e=>{let r=0;return a.weights.forEach(s=>{const o=s.results.find(l=>l.student_id===e);r+=parseFloat((o==null?void 0:o.point)||0)}),r.toFixed(2)},c=e=>(e=parseFloat(e),isNaN(e)?"N/A":e>=94?"A":e>=90?"A-":e>=87?"B+":e>=84?"B":e>=80?"B-":e>=77?"C+":e>=74?"C":e>=70?"C-":e>=67?"D+":e>=64?"D":e>=60?"D-":"F"),N=()=>{const e=a.studentsList.map(r=>{const s=p(r.id);return{student_id:r.id,grade_point:s,grade_letter:c(s),grade_description:"",grade_scale:u.value.toString(),grade_complaint:!1,grade_comment:"",changed_grade:null,grade_status:"Submitted",changed_by:null,user_id:G.value.id,year_id:a.semester.year_id,semester_id:a.semester.id,section_id:a.section.id,course_id:a.course.id}});g.grades=e,g.post(route("grades.store"),{onSuccess:()=>{v.fire("Success","Grades successfully submitted!","success"),g.reset()},onError:()=>{v.fire("Error","Failed to submit grades.","error")}})},F=f(()=>a.studentsList.every(e=>a.weights.every(r=>{var s;return(s=r.results)==null?void 0:s.some(o=>o.student_id===e.id&&o.point!==null&&o.point!==void 0)}))),y=e=>a.section.grades.find(r=>r.student_id===e),m=x(null),q=()=>{const e=new FormData;e.append("grades_file",m.value.files[0]),e.append("course_id",a.course.id),e.append("section_id",a.section.id),e.append("semester_id",a.semester.id),e.append("year_id",a.semester.year_id),A.post(route("sectionGrades.import"),e,{forceFormData:!0})};return(e,r)=>(n(),i("div",B,[!a.section.grades||a.section.grades.filter(s=>s.course_id===a.course.id).length===0?(n(),i("div",C,[r[5]||(r[5]=t("h2",{class:"text-xl font-bold mb-4 text-gray-900 dark:text-gray-100"}," Grade Generation Form ",-1)),t("div",E,[r[1]||(r[1]=t("h2",{class:"text-lg font-semibold mb-2 text-gray-800 dark:text-gray-200"},"Import Grades",-1)),t("form",{onSubmit:L(q,["prevent"]),enctype:"multipart/form-data"},[t("input",{type:"file",ref_key:"fileInput",ref:m,name:"grades_file",accept:".csv, .xlsx, .xls",class:"border p-2 rounded text-sm",required:""},null,512),r[0]||(r[0]=t("button",{type:"submit",class:"bg-blue-600 text-white px-4 py-2 rounded ml-2"}," Import ",-1))],32),e.importSuccess?(n(),i("p",O,d(e.importSuccess),1)):_("",!0),e.importError?(n(),i("p",j,d(e.importError),1)):_("",!0)]),t("table",I,[t("thead",P,[t("tr",null,[r[2]||(r[2]=t("th",{class:"px-4 py-2"},"#",-1)),r[3]||(r[3]=t("th",{class:"px-4 py-2 text-left"},"Student Name",-1)),t("th",W," Total ("+d(u.value)+" pt) ",1),r[4]||(r[4]=t("th",{class:"px-4 py-2"},"Grade",-1))])]),t("tbody",null,[(n(!0),i(h,null,k(a.studentsList,(s,o)=>(n(),i("tr",{key:s.id,class:w(["text-sm border-b",o%2===0?"bg-white dark:bg-gray-800":"bg-gray-50 dark:bg-gray-700"])},[t("td",T,d(o+1),1),t("td",V,d(s.firstName)+" "+d(s.middleName),1),t("td",z,d(p(s.id)),1),t("td",H,d(c(p(s.id))),1)],2))),128))]),t("tfoot",null,[t("tr",null,[t("td",M,[F.value?(n(),i("button",{key:0,onClick:N,class:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white text-sm rounded"}," Submit Grades ")):(n(),i("p",U," Please enter all required weight values before submitting grades. "))])])])])])):(n(),i("div",J,[r[9]||(r[9]=t("h2",{class:"text-xl font-bold mb-4 text-gray-900 dark:text-gray-100"}," Submitted Grades ",-1)),t("table",K,[t("thead",Q,[t("tr",null,[r[6]||(r[6]=t("th",{class:"px-4 py-2"},"#",-1)),r[7]||(r[7]=t("th",{class:"px-4 py-2 text-left"},"Student Name",-1)),t("th",R," Total ("+d(u.value)+" pt) ",1),r[8]||(r[8]=t("th",{class:"px-4 py-2"},"Grade",-1))])]),t("tbody",null,[(n(!0),i(h,null,k(a.studentsList,(s,o)=>{var l,b;return n(),i("tr",{key:s.id,class:w(["text-sm border-b",o%2===0?"bg-white dark:bg-gray-800":"bg-gray-50 dark:bg-gray-700"])},[t("td",X,d(o+1),1),t("td",Y,d(s.firstName)+" "+d(s.middleName),1),t("td",Z,d(((l=y(s.id))==null?void 0:l.grade_point)??"N/A"),1),t("td",$,d(((b=y(s.id))==null?void 0:b.grade_letter)??"N/A"),1)],2)}),128))])])]))]))}};export{re as default};
