import{r as _,x as U,q as M,O as P,c as l,o as i,a as e,h as c,t as d,w as g,k as f,F as D,f as T,m as A,aN as j,n as C,i as b,T as q,u as r}from"./app-BryW9RFD.js";import{s as R}from"./index-Ddy5If_X.js";import{s as I}from"./index-CObJv2Up.js";import{s as z}from"./index-BENNWYNt.js";import{P as h}from"./PrimaryButton-X8usO-dP.js";import"./index-CFuPkxQq.js";import"./index-BnHMhz9R.js";import"./index-DnVBe3ca.js";import"./index-D4my0ZI1.js";import"./index-lTIHPC0l.js";import"./index-C_27OtwU.js";import"./index-BEZ3r4nl.js";import"./index-CzH4Rvmd.js";import"./index-h3juVsv_.js";import"./index-DYib1zyw.js";import"./index-J86LN7ot.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const Y={class:"max-w-7xl mx-auto py-10 px-4 space-y-8"},G={class:"text-center"},H={class:"text-2xl font-bold text-gray-800 dark:text-white"},J={key:"details",class:"bg-white dark:bg-gray-800 p-6 rounded shadow"},K={class:"text-sm text-gray-600 dark:text-gray-300"},Q={class:"text-sm text-gray-600 dark:text-gray-300"},W={class:"text-sm text-gray-600 dark:text-gray-300"},X={class:"mt-4"},Z={key:"attendance",class:"bg-white dark:bg-gray-800 p-6 rounded shadow"},ee={class:"overflow-x-auto"},te={class:"w-full text-sm text-left text-gray-700 dark:text-gray-300 border border-gray-200 dark:border-gray-700 rounded"},se={class:"px-4 py-2"},ae={class:"px-2 py-2 text-center cursor-pointer"},re={class:"inline-flex items-center justify-center w-full h-full cursor-pointer"},oe=["name","onUpdate:modelValue"],le={key:0,class:"w-2 h-2 bg-white rounded-full"},ie={class:"px-2 py-2 text-center cursor-pointer"},de={class:"inline-flex items-center justify-center w-full h-full cursor-pointer"},ne=["name","onUpdate:modelValue"],ce={key:0,class:"w-2 h-2 bg-white rounded-full"},ue={class:"px-2 py-2 text-center cursor-pointer"},me={class:"inline-flex items-center justify-center w-full h-full cursor-pointer"},ye=["name","onUpdate:modelValue"],pe={key:0,class:"w-2 h-2 bg-white rounded-full"},xe={class:"mt-4 flex gap-2"},ge={key:"list"},fe={class:"flex justify-end"},be={class:"overflow-x-auto bg-white dark:bg-gray-800 rounded-lg shadow border border-gray-300 dark:border-gray-600"},ve={class:"w-full min-w-[800px] table-fixed"},_e={class:"px-4 py-3 text-sm text-gray-700 dark:text-gray-300"},he={class:"px-4 py-3 text-sm text-gray-700 dark:text-gray-300"},ke={class:"px-4 py-3 text-sm text-gray-700 dark:text-gray-300 flex gap-2"},we=["onClick"],Ce=["onClick"],Ve={key:1},Ae={key:0,class:"bg-gray-100 dark:bg-gray-700 border-t border-gray-300 dark:border-gray-600"},je={class:"px-4 py-2"},Se={key:0,class:"text-red-500 text-xs mt-1"},Ne={class:"px-4 py-2"},Ue={key:0,class:"text-red-500 text-xs mt-1"},De={class:"px-4 py-2 flex flex-col sm:flex-row sm:items-center gap-2"},Te={key:0,class:"text-red-500 text-xs mt-1"},Qe={__name:"ClassSessions",props:{section:{required:!0,type:Object},course:{required:!0,type:Object},instructor:{required:!0,type:Object},activeSemester:{required:!0,type:Object},classSessions:{required:!0,type:Array},students:{required:!0,type:Array},rooms:{required:!0,type:Array}},setup(y){const p=y,v=_(!1),k=_(!1),w=_(!1),u=_(null);function B(){v.value=!v.value}function $(n){u.value=n,k.value=!0,w.value=!1}function O(n){u.value=n,w.value=!0,k.value=!1,p.students.forEach(s=>{s.id in a.value||(a.value[s.id]="")})}function V(){u.value=null,k.value=!1,w.value=!1}const o=U({section_id:p.section.id,course_id:p.course.id,instructor_id:p.instructor.id,semester_id:p.activeSemester.id,room_id:null,date_time:null,class_about:""});function E(){o.post(route("classSessions.store"),{onSuccess:()=>{v.value=!1,o.reset("room_id","date_time","class_about")}})}const a=_({});M(u,n=>{var s;((s=n==null?void 0:n.attendances)==null?void 0:s.length)>0?(a.value={},n.attendances.forEach(m=>{const t=m.records;t!=null&&t.student&&(t!=null&&t.status)&&(a.value[t.student]=t.status)})):(a.value={},p.students.forEach(m=>{a.value[m.id]=""}))});function F(){const n={class_session_id:u.value.id,records:Object.entries(a.value).map(([s,m])=>({student_id:parseInt(s),status:m}))};U(n).post(route("attendances.store"),{onSuccess:()=>{V()}})}return P(()=>{p.students.forEach(n=>{n.id in a.value||(a.value[n.id]="")})}),(n,s)=>(i(),l("div",Y,[e("div",G,[e("h1",H," Your Class Session for "+d(y.activeSemester.year.name)+" Semester - "+d(y.activeSemester.level)+" In This Section ",1)]),c(q,{mode:"out-in","enter-active-class":"transition duration-300 ease-out","enter-from-class":"opacity-0 scale-75","enter-to-class":"opacity-100 scale-100","leave-active-class":"transition duration-200 ease-in","leave-from-class":"opacity-100 scale-100","leave-to-class":"opacity-0 scale-75"},{default:g(()=>{var m;return[k.value?(i(),l("div",J,[s[4]||(s[4]=e("h2",{class:"text-lg font-semibold text-gray-800 dark:text-white mb-4"}," Class Details ",-1)),e("p",K," Date: "+d(u.value.date),1),e("p",Q," Room: "+d(((m=u.value.room)==null?void 0:m.name)||"N/A"),1),e("p",W," About: "+d(u.value.class_about||"N/A"),1),e("div",X,[c(h,{onClick:V},{default:g(()=>s[3]||(s[3]=[f("Back")])),_:1})])])):w.value?(i(),l("div",Z,[s[8]||(s[8]=e("h2",{class:"text-lg font-semibold text-gray-800 dark:text-white mb-4"}," Take Attendance ",-1)),e("div",ee,[e("table",te,[s[5]||(s[5]=e("thead",{class:"bg-gray-100 dark:bg-gray-700"},[e("tr",null,[e("th",{class:"px-4 py-2 min-w-[120px]"},"Student"),e("th",{class:"px-2 py-2 text-center min-w-[100px]"}," Present "),e("th",{class:"px-2 py-2 text-center min-w-[100px]"}," Permission "),e("th",{class:"px-2 py-2 text-center min-w-[100px]"}," Absent ")])],-1)),e("tbody",null,[(i(!0),l(D,null,T(y.students,t=>(i(),l("tr",{key:t.id,class:"border-t border-gray-200 dark:border-gray-700"},[e("td",se,d(t.firstName)+" "+d(t.lastName),1),e("td",ae,[e("label",re,[A(e("input",{type:"radio",class:"sr-only",name:`attendance_${t.id}`,value:"present","onUpdate:modelValue":x=>a.value[t.id]=x},null,8,oe),[[j,a.value[t.id]]]),e("div",{class:C(["w-5 h-5 border-2 border-gray-500 rounded-full flex items-center justify-center",a.value[t.id]==="present"?"bg-green-500":"bg-white"])},[a.value[t.id]==="present"?(i(),l("div",le)):b("",!0)],2)])]),e("td",ie,[e("label",de,[A(e("input",{type:"radio",class:"sr-only",name:`attendance_${t.id}`,value:"permission","onUpdate:modelValue":x=>a.value[t.id]=x},null,8,ne),[[j,a.value[t.id]]]),e("div",{class:C(["w-5 h-5 border-2 border-gray-500 rounded-full flex items-center justify-center",a.value[t.id]==="permission"?"bg-yellow-500":"bg-white"])},[a.value[t.id]==="permission"?(i(),l("div",ce)):b("",!0)],2)])]),e("td",ue,[e("label",me,[A(e("input",{type:"radio",class:"sr-only",name:`attendance_${t.id}`,value:"absent","onUpdate:modelValue":x=>a.value[t.id]=x},null,8,ye),[[j,a.value[t.id]]]),e("div",{class:C(["w-5 h-5 border-2 border-gray-500 rounded-full flex items-center justify-center",a.value[t.id]==="absent"?"bg-red-500":"bg-white"])},[a.value[t.id]==="absent"?(i(),l("div",pe)):b("",!0)],2)])])]))),128))])])]),e("div",xe,[c(h,{onClick:F},{default:g(()=>s[6]||(s[6]=[f("Submit")])),_:1}),c(h,{onClick:V,class:"bg-gray-300 dark:bg-gray-600 text-gray-800 dark:text-white"},{default:g(()=>s[7]||(s[7]=[f("Cancel")])),_:1})])])):(i(),l("div",ge,[e("div",fe,[c(h,{onClick:B},{default:g(()=>[f(d(v.value?"Cancel":"Add Class Session"),1)]),_:1})]),e("div",be,[e("table",ve,[s[12]||(s[12]=e("thead",{class:"bg-gray-100 dark:bg-gray-700"},[e("tr",null,[e("th",{class:"text-left px-4 py-2 font-medium text-sm text-gray-800 dark:text-gray-200"}," Date "),e("th",{class:"text-left px-4 py-2 font-medium text-sm text-gray-800 dark:text-gray-200"}," Room "),e("th",{class:"text-left px-4 py-2 font-medium text-sm text-gray-800 dark:text-gray-200"}," Actions ")])],-1)),e("tbody",null,[y.classSessions.length>0?(i(!0),l(D,{key:0},T(y.classSessions,(t,x)=>{var S,N;return i(),l("tr",{key:t.id,class:C([x%2===0?"bg-white dark:bg-gray-800":"bg-gray-50 dark:bg-gray-700","border-b border-gray-300 dark:border-gray-600"])},[e("td",_e,d(t.date),1),e("td",he,d(((S=t.room)==null?void 0:S.name)||"N/A"),1),e("td",ke,[e("button",{onClick:L=>O(t),class:"flex items-center justify-center px-3 py-1 text-xs font-medium text-gray-800 dark:text-gray-200 bg-gray-200 dark:bg-gray-600 rounded hover:bg-gray-300 dark:hover:bg-gray-500"},[s[9]||(s[9]=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M5 13l4 4L19 7"})],-1)),f(" "+d(((N=t.attendances)==null?void 0:N.length)>0?"Update Attendance":"Take Attendance"),1)],8,we),e("button",{onClick:L=>$(t),class:"flex items-center justify-center px-3 py-1 text-xs font-medium text-gray-800 dark:text-gray-200 bg-gray-200 dark:bg-gray-600 rounded hover:bg-gray-300 dark:hover:bg-gray-500"},s[10]||(s[10]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 10l4.553 2.276A2 2 0 0119 14.618V20a2 2 0 01-2 2h-8a2 2 0 01-2-2v-5.382a2 2 0 01.447-1.342L9 10m6-6h.01"})],-1),f(" Details ")]),8,Ce)])],2)}),128)):(i(),l("tr",Ve,s[11]||(s[11]=[e("td",{colspan:"3",class:"text-center px-4 py-6 text-sm text-gray-500 dark:text-gray-300"}," No sessions set. ",-1)]))),c(q,{name:"fade"},{default:g(()=>[v.value?(i(),l("tr",Ae,[e("td",je,[c(r(I),{modelValue:r(o).date_time,"onUpdate:modelValue":s[0]||(s[0]=t=>r(o).date_time=t),showTime:"",placeholder:"Select Date & Time",class:"w-full"},null,8,["modelValue"]),r(o).errors.date_time?(i(),l("div",Se,d(r(o).errors.date_time),1)):b("",!0)]),e("td",Ne,[c(r(R),{modelValue:r(o).room_id,"onUpdate:modelValue":s[1]||(s[1]=t=>r(o).room_id=t),options:y.rooms,"option-label":"name","option-value":"id",placeholder:"Select Room",class:"w-full"},null,8,["modelValue","options"]),r(o).errors.room_id?(i(),l("div",Ue,d(r(o).errors.room_id),1)):b("",!0)]),e("td",De,[c(r(z),{modelValue:r(o).class_about,"onUpdate:modelValue":s[2]||(s[2]=t=>r(o).class_about=t),placeholder:"Class description",class:"w-full"},null,8,["modelValue"]),r(o).errors.class_about?(i(),l("div",Te,d(r(o).errors.class_about),1)):b("",!0),c(h,{class:"mt-2 sm:mt-0",disabled:r(o).processing,onClick:E},{default:g(()=>[f(d(r(o).processing?"Saving...":"Save"),1)]),_:1},8,["disabled"])])])):b("",!0)]),_:1})])])])]))]}),_:1})]))}};export{Qe as default};
