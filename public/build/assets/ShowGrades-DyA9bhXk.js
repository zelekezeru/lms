import{m as b,r as h,x as N,c as a,o as i,a as e,k as A,F as c,e as p,t as o,W as D}from"./app-B_9gkXmO.js";import{S as k}from"./sweetalert2.esm.all-89IKscqO.js";const L={class:"overflow-x-auto px-4 py-6"},B={key:0},O={class:"min-w-full border rounded shadow bg-white dark:bg-gray-900"},j={class:"bg-gray-100 dark:bg-gray-800 text-sm"},P={class:"px-4 py-2"},R={class:"px-4 py-2"},C={class:"px-4 py-2"},E={class:"px-4 py-2 font-semibold"},I={class:"px-4 py-2"},W={colspan:"100%",class:"text-center py-4"},T={key:1,class:"text-sm text-red-600"},q={key:1},V={class:"min-w-full border rounded shadow bg-white dark:bg-gray-900"},H={class:"px-4 py-2"},M={class:"px-4 py-2"},U={class:"px-4 py-2"},z={class:"px-4 py-2"},Q={__name:"ShowGrades",props:{section:Object,course:Object,semester:Object,weights:Array,instructor:Object,studentsList:Array,studentResults:Object},setup(v){const r=v,f=b(()=>r.weights.reduce((t,s)=>t+(parseFloat(s.point)||0),0)),w=h({id:r.instructor.id}),m=N({grades:[]}),y=t=>{let s=0;return r.weights.forEach(d=>{const n=r.studentResults[t][d.id];n&&n.point&&(s+=parseFloat(n.point))}),s.toFixed(2)},g=t=>(t=parseFloat(t),isNaN(t)?"N/A":t>=94?"A":t>=90?"A-":t>=87?"B+":t>=84?"B":t>=80?"B-":t>=77?"C+":t>=74?"C":t>=70?"C-":t>=67?"D+":t>=64?"D":t>=60?"D-":"F"),S=()=>{const t=r.studentsList.map(s=>{const d=y(s.id);return{student_id:s.id,grade_point:d,grade_letter:g(d),grade_scale:f.value.toString(),grade_status:"Submitted",user_id:w.value.id,year_id:r.semester.year_id,semester_id:r.semester.id,section_id:r.section.id,course_id:r.course.id}});m.grades=t,m.post(route("grades.store"),{onSuccess:()=>{k.fire("Success","Grades successfully submitted!","success"),m.reset()},onError:()=>{k.fire("Error","Failed to submit grades.","error")}})},F=b(()=>r.studentsList.every(t=>r.weights.every(s=>{var d,n;return((d=r.studentResults[t.id][s.id])==null?void 0:d.point)!==null&&((n=r.studentResults[t.id][s.id])==null?void 0:n.point)!==void 0}))),_=t=>r.section.grades.find(s=>s.student_id===t),x=h(null),G=()=>{const t=new FormData;t.append("grades_file",x.value.files[0]),t.append("course_id",r.course.id),t.append("section_id",r.section.id),t.append("semester_id",r.semester.id),t.append("year_id",r.semester.year_id),D.post(route("sectionGrades.import"),t,{forceFormData:!0})};return(t,s)=>(i(),a("div",L,[!r.section.grades||r.section.grades.filter(d=>d.course_id===r.course.id).length===0?(i(),a("div",B,[s[4]||(s[4]=e("h2",{class:"text-xl font-bold mb-4"},"Grade Generation Form",-1)),e("form",{onSubmit:A(G,["prevent"]),enctype:"multipart/form-data",class:"mb-4"},[e("input",{type:"file",ref_key:"fileInput",ref:x,accept:".csv,.xlsx,.xls",class:"border p-2 rounded text-sm",required:""},null,512),s[0]||(s[0]=e("button",{type:"submit",class:"bg-blue-600 text-white px-4 py-2 rounded ml-2"},"Import",-1))],32),e("table",O,[e("thead",j,[e("tr",null,[s[1]||(s[1]=e("th",{class:"px-4 py-2"},"#",-1)),s[2]||(s[2]=e("th",{class:"px-4 py-2 text-left"},"Student",-1)),(i(!0),a(c,null,p(r.weights,d=>(i(),a("th",{key:d.id,class:"px-4 py-2 text-center"},o(d.name)+" ("+o(d.point)+"pt) ",1))),128)),e("th",P,"Total ("+o(f.value)+"pt)",1),s[3]||(s[3]=e("th",{class:"px-4 py-2"},"Grade",-1))])]),e("tbody",null,[(i(!0),a(c,null,p(r.studentsList,(d,n)=>(i(),a("tr",{key:d.id,class:"text-sm"},[e("td",R,o(n+1),1),e("td",C,o(d.firstName)+" "+o(d.middleName),1),(i(!0),a(c,null,p(r.weights,l=>{var u;return i(),a("td",{key:l.id,class:"px-4 py-2 text-center"},o(((u=r.studentResults[d.id][l.id])==null?void 0:u.point)??"N/A"),1)}),128)),e("td",E,o(y(d.id)),1),e("td",I,o(g(y(d.id))),1)]))),128))]),e("tfoot",null,[e("tr",null,[e("td",W,[F.value?(i(),a("button",{key:0,onClick:S,class:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded"}," Submit Grades ")):(i(),a("p",T," Please enter all required weight values before submitting. "))])])])])])):(i(),a("div",q,[s[6]||(s[6]=e("h2",{class:"text-xl font-bold mb-4"},"Submitted Grades",-1)),e("table",V,[s[5]||(s[5]=e("thead",{class:"bg-gray-100 dark:bg-gray-800 text-sm"},[e("tr",null,[e("th",{class:"px-4 py-2"},"#"),e("th",{class:"px-4 py-2 text-left"},"Student"),e("th",{class:"px-4 py-2"},"Total"),e("th",{class:"px-4 py-2"},"Grade")])],-1)),e("tbody",null,[(i(!0),a(c,null,p(r.studentsList,(d,n)=>{var l,u;return i(),a("tr",{key:d.id,class:"text-sm"},[e("td",H,o(n+1),1),e("td",M,o(d.firstName)+" "+o(d.middleName),1),e("td",U,o(((l=_(d.id))==null?void 0:l.grade_point)??"N/A"),1),e("td",z,o(((u=_(d.id))==null?void 0:u.grade_letter)??"N/A"),1)])}),128))])])]))]))}};export{Q as default};
