import{r as v,m as b,c,o as p,a as i,t as u,F as w,e as k,k as N,W as S}from"./app-DRgEhh1p.js";import{S as d}from"./sweetalert2.esm.all-89IKscqO.js";/* empty css                        */const F={class:"space-y-6"},R={class:"text-lg font-semibold text-gray-900 dark:text-white"},B={class:"overflow-x-auto"},C={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},W={class:"bg-white divide-y divide-gray-200 dark:bg-gray-800 dark:divide-gray-700"},E=["data-weight-id"],D={class:"px-6 py-4 whitespace-nowrap"},V=["onClick"],$={class:"px-6 py-4 whitespace-nowrap"},A=["value","onInput","disabled","max"],P={class:"px-6 py-4 whitespace-nowrap"},T={class:"px-6 py-4 whitespace-nowrap"},M={__name:"ShowResults",props:{},setup(x){const n=x,l=v(null),a=v({});b(()=>n.weights.reduce((t,e)=>t+(parseFloat(e.point)||0),0));const m=t=>{l.value=t,a.value[t]||(a.value[t]={}),setTimeout(()=>{const e=document.querySelector(`[data-weight-id="${t}"]`);e&&e.scrollIntoView({behavior:"smooth",block:"center"})},100)},f=()=>{let t=0;return n.weights.forEach(e=>{var s;if(l.value===e.id){const r=parseFloat((s=a.value[e.id])==null?void 0:s[n.student.id]);isNaN(r)||(t+=r)}else{const r=e.results.find(o=>o.student_id===n.student.id);if(r){const o=parseFloat(r.point);isNaN(o)||(t+=o)}}}),t.toFixed(2)},h=()=>{const t=parseFloat(f());return isNaN(t)?"N/A":t>=94?"A (4.0)":t>=90?"A- (3.7)":t>=87?"B+ (3.3)":t>=84?"B (3.0)":t>=80?"B- (2.7)":t>=77?"C+ (2.3)":t>=74?"C (2.0)":t>=70?"C- (1.7)":t>=67?"D+ (1.3)":t>=64?"D (1.0)":t>=60?"D- (0.7)":"F (0.0)"},g=t=>{var s;if(((s=a.value[t])==null?void 0:s[n.student.id])!==void 0)return a.value[t][n.student.id];const e=n.weights.find(r=>r.id===t);if(e){const r=e.results.find(o=>o.student_id===n.student.id);return r?r.point:""}return""},_=(t,e)=>{a.value[t]||(a.value[t]={}),a.value[t][n.student.id]=e},y=()=>{const t=l.value,e=n.weights.find(o=>o.id===t);if(!t||!a.value[t]){d.fire({icon:"warning",title:"No active weight",text:"Please activate a weight column before submitting."});return}const s=parseFloat(a.value[t][n.student.id]);if(isNaN(s)||s<0||s>e.point){d.fire({icon:"error",title:"Invalid Input",text:`Enter a valid score between 0 and ${e.point}.`});return}const r=[{weight_id:t,student_id:n.student.id,point:s}];S.post(route("results.store"),{results:r},{onSuccess:()=>{d.fire({icon:"success",title:"Saved!",text:`Result saved for ${e.name}.`,timer:2e3,showConfirmButton:!1}),l.value=null},onError:()=>{d.fire({icon:"error",title:"Error",text:"Something went wrong while saving."})}})};return(t,e)=>(p(),c("div",F,[i("h2",R,"Results for "+u(t.student.name),1),i("div",B,[i("table",C,[e[0]||(e[0]=i("thead",null,[i("tr",null,[i("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Weight"),i("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Result"),i("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Total Points"),i("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Grade")])],-1)),i("tbody",W,[(p(!0),c(w,null,k(t.weights,s=>(p(),c("tr",{key:s.id,"data-weight-id":s.id},[i("td",D,[i("button",{onClick:r=>m(s.id),class:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300"},u(s.name),9,V)]),i("td",$,[i("input",{type:"number",value:g(s.id),onInput:r=>_(s.id,r.target.value),disabled:l.value!==s.id,max:s.point,class:"border border-gray-300 rounded-md p-2 w-full"},null,40,A)]),i("td",P,u(f()),1),i("td",T,u(h()),1)],8,E))),128))])])]),i("button",{onClick:N(y,["prevent"]),class:"mt-4 bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded"}," Save Results ")]))}};export{M as default};
