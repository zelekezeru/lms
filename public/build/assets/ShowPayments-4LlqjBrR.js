import{r as k,x as C,q as j,c as m,o as i,a as e,h as o,k as _,u as s,F as h,f as T,t as d,w,l as F,i as O,m as x,y as b,n as A,S as $}from"./app-BrFhRYXM.js";import{S as N}from"./sweetalert2.esm.all-89IKscqO.js";/* empty css                        */import{_ as M}from"./Modal-CrjbpO2V.js";import{_ as y}from"./InputError-B-R3hAbd.js";import{r as q}from"./PlusCircleIcon-BXkZ72yJ.js";import{s as B}from"./index-oL0qAXjG.js";import{s as v}from"./index-DjSQKStH.js";import"./index-Cf8s0F8X.js";import"./index-BQCiHZp0.js";import"./index-Bz12CTHG.js";import"./index-rwZxPwlD.js";import"./index-Ul63Ihym.js";import"./index-DUoDE9ce.js";const W={class:""},R={class:"flex items-center justify-between mb-4"},z={class:"overflow-x-auto"},I={class:"mt-8 border-t border-b border-gray-300 dark:border-gray-600 pt-4 pb-4"},Y={key:0,class:"text-center"},G={key:1,class:"flex flex-col"},H={class:"mt-8 border-t border-b border-gray-300 dark:border-gray-600 pt-4 pb-4"},J={class:"min-w-full table-auto border border-gray-300 dark:border-gray-600"},K={class:"w-10 px-4 py-2 text-sm text-gray-600 dark:text-gray-300 border-r border-gray-300 dark:border-gray-600"},Q={class:"w-60 px-4 py-2 text-sm text-gray-600 dark:text-gray-300 border-r border-gray-300 dark:border-gray-600"},X={class:"w-40 px-4 py-2 text-sm text-gray-600 dark:text-gray-300 border-r border-gray-300 dark:border-gray-600"},Z={class:"w-20 px-4 py-2 text-sm text-gray-600 dark:text-gray-300 border-r border-gray-300 dark:border-gray-600"},ee={class:"w-20 px-4 py-2 text-sm text-gray-600 dark:text-gray-300 border-r border-gray-300 dark:border-gray-600"},te={class:"w-20 px-4 py-2 text-sm text-gray-600 dark:text-gray-300 border-r border-gray-300 dark:border-gray-600"},re={class:"w-20 px-4 py-2 text-sm text-gray-600 dark:text-gray-300 border-r border-gray-300 dark:border-gray-600"},se={class:"w-20 px-4 py-2 text-sm text-gray-600 dark:text-gray-300 border-r border-gray-300 dark:border-gray-600"},ae={class:"w-40 px-4 py-2 text-sm text-gray-600 dark:text-gray-300 border-r border-gray-300 dark:border-gray-600"},oe={key:2,class:"flex flex-col"},de={class:"text-lg font-medium text-gray-900 dark:text-gray-100"},le={class:"w-full px-16 py-8"},ne={class:"flex justify-end mt-4"},me=["disabled"],ie={class:"w-full px-8 py-6"},ye={class:"text-xl font-semibold mb-4 text-gray-900 dark:text-gray-100"},ue={class:"text-yellow-700 underline"},pe={class:"mb-4"},ge={class:"mb-4"},xe={key:0},be={class:"text-md font-bold"},ce={class:"mb-4"},fe={class:"mb-4"},ke={class:"mb-4"},_e={class:"mb-4"},he={class:"mb-4"},we={class:"mb-4"},ve={class:"flex justify-end mt-4"},Pe=["disabled"],$e={__name:"ShowPayments",props:{student:{type:Object,required:!0},payments:{type:Array,required:!0},activeSemester:{type:Object,required:!0},paymentMethods:Array,paymentTypes:Array},setup(l){const p=l,c=k(!1),g=k(!1),u=C({payments:[],student_id:p.student.id}),a=C({student_id:p.student.id,payment_method_id:null,payment_type_id:null,payment_date:new Date().toISOString().slice(0,10),paid_amount:null,total_amount:null,description:null,status:null,reference_number:null}),P=p.student.enrollments.filter(n=>n.status=="pending"),U=()=>{c.value=!1,u.reset()},D=()=>{u.post(route("payments",p.student.id),{preserveScroll:!0,onSuccess:()=>{c.value=!1,u.reset()}})},f=k(!1),S=()=>{g.value=!1,a.reset()};j(()=>a.payment_type_id,()=>{const n=p.paymentTypes.find(t=>t.id==a.payment_type_id&&t.study_mode_id==p.student.studyMode.id);n&&n.duration=="per-course"&&(f.value=!0,console.log(f.value),a.total_amount=n.amount*P.length)});const L=[{label:"pending",value:"pending"},{label:"completed",value:"completed"},{label:"canceled",value:"failed"}],E=()=>{a.post(route("payments.store",{student:p.student.id}),{onSuccess:()=>{N.fire("Success!","Payment has been created successfully.","success"),g.value=!1,a.reset()},onError:n=>{N.fire("Error!","Failed to create the payment. Please check the form for errors.","error"),console.log(n)}})};return(n,t)=>(i(),m(h,null,[e("div",W,[e("div",R,[t[12]||(t[12]=e("h2",{class:"text-xl font-semibold text-gray-900 dark:text-gray-100"}," Payments ",-1)),e("button",{onClick:t[0]||(t[0]=r=>g.value=!g.value),class:"flex text-green-600 hover:text-green-800"},[o(s(q),{class:"mx-2 w-8 h-8"}),t[11]||(t[11]=_(" Create Payment "))])]),e("div",z,[e("div",I,[l.payments?l.payments?(i(),m("div",G,[e("div",H,[t[15]||(t[15]=e("span",{class:"text-sm text-gray-500 dark:text-gray-400"},"Enrolled Payments",-1)),e("table",J,[t[14]||(t[14]=e("thead",null,[e("tr",{class:"bg-gray-50 dark:bg-gray-700"},[e("th",{class:"w-10 px-4 py-2 text-left text-sm font-medium text-gray-700 dark:text-gray-200 border-r border-gray-300 dark:border-gray-600"}," No. "),e("th",{class:"w-60 px-4 py-2 text-left text-sm font-medium text-gray-700 dark:text-gray-200 border-r border-gray-300 dark:border-gray-600"}," Description "),e("th",{class:"w-20 px-4 py-2 text-left text-sm font-medium text-gray-700 dark:text-gray-200 border-r border-gray-300 dark:border-gray-600"}," Type "),e("th",{class:"w-20 px-4 py-2 text-left text-sm font-medium text-gray-700 dark:text-gray-200 border-r border-gray-300 dark:border-gray-600"}," Method "),e("th",{class:"w-20 px-4 py-2 text-left text-sm font-medium text-gray-700 dark:text-gray-200 border-r border-gray-300 dark:border-gray-600"}," Total Amount "),e("th",{class:"w-20 px-4 py-2 text-left text-sm font-medium text-gray-700 dark:text-gray-200 border-r border-gray-300 dark:border-gray-600"}," Paid Amount "),e("th",{class:"w-40 px-4 py-2 text-left text-sm font-medium text-gray-700 dark:text-gray-200 border-r border-gray-300 dark:border-gray-600"}," Date "),e("th",{class:"w-20 px-4 py-2 text-left text-sm font-medium text-gray-700 dark:text-gray-200 border-r border-gray-300 dark:border-gray-600"}," Reference "),e("th",{class:"w-40 px-4 py-2 text-left text-sm font-medium text-gray-700 dark:text-gray-200 border-r border-gray-300 dark:border-gray-600"}," Status ")])],-1)),e("tbody",null,[(i(!0),m(h,null,T(l.payments,(r,V)=>(i(),m("tr",{key:r.id,class:A([V%2===0?"bg-white dark:bg-gray-800":"bg-gray-50 dark:bg-gray-700","border-b border-gray-300 dark:border-gray-600"])},[e("td",K,d(V+1),1),e("td",Q,[o(s($),{href:n.route("payments.show",{payment:r.id})},{default:w(()=>[_(d(r.description),1)]),_:2},1032,["href"])]),e("td",X,d(r.payment_type?r.payment_type.type:"N/A"),1),e("td",Z,d(r.payment_method?r.payment_method.bank_name:"N/A"),1),e("td",ee,d(r.total_amount),1),e("td",te,d(r.paid_amount),1),e("td",re,d(r.payment_date),1),e("td",se,d(r.reference_number),1),e("td",ae,[e("span",{class:A({"text-yellow-500":r.status==="pending","text-green-500":r.status==="completed","text-red-500":r.status==="failed","text-blue-500":r.status==="refunded"})},d(r.status.charAt(0).toUpperCase()+r.status.slice(1)),3)])],2))),128))])])])])):(i(),m("div",oe,[t[16]||(t[16]=e("span",{class:"text-sm text-gray-500 dark:text-gray-400"},"No Payments Enrolled",-1)),e("span",de,d(l.student.name)+" has not enrolled in any payments yet. ",1)])):(i(),m("div",Y,t[13]||(t[13]=[e("p",{class:"text-gray-500 dark:text-gray-400"}," No payment information available. ",-1)])))])])]),o(M,{show:c.value,onClose:t[2]||(t[2]=r=>c.value=!1),maxWidth:"6xl",class:"p-24 h-full"},{default:w(()=>[e("div",le,[t[17]||(t[17]=e("h1",{class:"text-lg mb-5"}," Pick Payments You Would like To Assign To This Section ",-1)),o(s(B),{id:"cousesList",modelValue:s(u).payments,"onUpdate:modelValue":t[1]||(t[1]=r=>s(u).payments=r),options:l.payments,optionLabel:"name","option-value":"id",appendTo:"self",filter:"",checkmark:"",multiple:"","list-style":"max-height: 500px",placeholder:"Select Payments",maxSelectedLabels:3,class:"w-full"},null,8,["modelValue","options"]),o(y,{message:s(u).errors.payments,class:"mt-2 text-sm text-red-500"},null,8,["message"]),e("div",ne,[e("button",{onClick:D,disabled:s(u).processing,class:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg shadow-md transition mr-5"},d(s(u).processing?"Assigning...":"Assign"),9,me),e("button",{onClick:U,class:"bg-red-600 hover:bg-red-700 text-white px-6 py-2 rounded-lg shadow-md transition"}," Close ")])])]),_:1},8,["show"]),o(M,{show:g.value,onClose:S,maxWidth:"md",class:"p-6"},{default:w(()=>[e("div",ie,[e("h1",ye,[t[18]||(t[18]=_(" Create Payment for â€“ ")),e("span",ue,d(l.student.first_name)+" "+d(l.student.middle_name),1)]),e("form",{onSubmit:F(E,["prevent"])},[e("div",pe,[t[19]||(t[19]=e("label",{for:"payment_method_id",class:"block text-gray-700 dark:text-gray-300 text-sm font-bold mb-2"}," Payment Method ",-1)),o(s(v),{modelValue:s(a).payment_method_id,"onUpdate:modelValue":t[3]||(t[3]=r=>s(a).payment_method_id=r),options:l.paymentMethods,optionLabel:"bank_name",optionValue:"id","append-to":"self",placeholder:"Select Payment Method",class:"w-full"},null,8,["modelValue","options"]),o(y,{message:s(a).errors.payment_method_id,class:"mt-2 text-sm text-red-500"},null,8,["message"])]),e("div",ge,[t[20]||(t[20]=e("label",{for:"payment_type_id",class:"block text-gray-700 dark:text-gray-300 text-sm font-bold mb-2"}," Payment Type ",-1)),o(s(v),{modelValue:s(a).payment_type_id,"onUpdate:modelValue":t[4]||(t[4]=r=>s(a).payment_type_id=r),options:l.paymentTypes,optionLabel:"type",optionValue:"id","append-to":"self",placeholder:"Select Type",class:"w-full"},null,8,["modelValue","options"]),o(y,{message:s(a).errors.payment_type_id,class:"mt-2 text-sm text-red-500"},null,8,["message"])]),f.value?(i(),m("div",xe,[e("h1",be," This Payment is for the following coures of the student in "+d(l.activeSemester.year.name)+" Semester "+d(l.activeSemester.level),1),(i(!0),m(h,null,T(s(P),r=>(i(),m("p",null,d(r.course.name),1))),256))])):O("",!0),e("div",ce,[t[21]||(t[21]=e("label",{for:"total_amount",class:"block text-gray-700 dark:text-gray-300 text-sm font-bold mb-2"}," Total Amount ",-1)),x(e("input",{type:"number","onUpdate:modelValue":t[5]||(t[5]=r=>s(a).total_amount=r),id:"total_amount",class:"shadow border rounded w-full py-2 px-3 text-gray-700 dark:bg-gray-800 dark:border-gray-600 dark:text-gray-300 focus:outline-none focus:shadow-outline"},null,512),[[b,s(a).total_amount]]),o(y,{message:s(a).errors.total_amount,class:"mt-2 text-sm text-red-500"},null,8,["message"])]),e("div",fe,[t[22]||(t[22]=e("label",{for:"paid_amount",class:"block text-gray-700 dark:text-gray-300 text-sm font-bold mb-2"}," Paid Amount ",-1)),x(e("input",{type:"number","onUpdate:modelValue":t[6]||(t[6]=r=>s(a).paid_amount=r),id:"paid_amount",class:"shadow border rounded w-full py-2 px-3 text-gray-700 dark:bg-gray-800 dark:border-gray-600 dark:text-gray-300 focus:outline-none focus:shadow-outline"},null,512),[[b,s(a).paid_amount]]),o(y,{message:s(a).errors.paid_amount,class:"mt-2 text-sm text-red-500"},null,8,["message"])]),e("div",ke,[t[23]||(t[23]=e("label",{for:"narration",class:"block text-gray-700 dark:text-gray-300 text-sm font-bold mb-2"}," Payment Description ",-1)),x(e("input",{type:"text","onUpdate:modelValue":t[7]||(t[7]=r=>s(a).description=r),id:"narration",class:"shadow border rounded w-full py-2 px-3 text-gray-700 dark:bg-gray-800 dark:border-gray-600 dark:text-gray-300 focus:outline-none focus:shadow-outline"},null,512),[[b,s(a).description]]),o(y,{message:s(a).errors.narration,class:"mt-2 text-sm text-red-500"},null,8,["message"])]),e("div",_e,[t[24]||(t[24]=e("label",{for:"payment_date",class:"block text-gray-700 dark:text-gray-300 text-sm font-bold mb-2"}," Payment Date ",-1)),x(e("input",{type:"date","onUpdate:modelValue":t[8]||(t[8]=r=>s(a).payment_date=r),id:"payment_date",class:"shadow border rounded w-full py-2 px-3 text-gray-700 dark:bg-gray-800 dark:border-gray-600 dark:text-gray-300 focus:outline-none focus:shadow-outline"},null,512),[[b,s(a).payment_date]]),o(y,{message:s(a).errors.payment_date,class:"mt-2 text-sm text-red-500"},null,8,["message"])]),e("div",he,[t[25]||(t[25]=e("label",{for:"status",class:"block text-gray-700 dark:text-gray-300 text-sm font-bold mb-2"}," Status ",-1)),o(s(v),{modelValue:s(a).status,"onUpdate:modelValue":t[9]||(t[9]=r=>s(a).status=r),options:L,optionLabel:"label",optionValue:"value","append-to":"self",placeholder:"Select Status",class:"w-full"},null,8,["modelValue"]),o(y,{message:s(a).errors.status,class:"mt-2 text-sm text-red-500"},null,8,["message"])]),e("div",we,[t[26]||(t[26]=e("label",{for:"reference_number",class:"block text-gray-700 dark:text-gray-300 text-sm font-bold mb-2"}," Reference Number (Optional) ",-1)),x(e("input",{type:"text","onUpdate:modelValue":t[10]||(t[10]=r=>s(a).reference_number=r),id:"reference_number",class:"shadow border rounded w-full py-2 px-3 text-gray-700 dark:bg-gray-800 dark:border-gray-600 dark:text-gray-300 focus:outline-none focus:shadow-outline"},null,512),[[b,s(a).reference_number]]),o(y,{message:s(a).errors.reference_number,class:"mt-2 text-sm text-red-500"},null,8,["message"])]),e("div",ve,[e("button",{type:"submit",disabled:s(a).processing,class:"bg-green-600 hover:bg-green-700 text-white px-6 py-2 rounded-lg shadow-md transition mr-5"},d(s(a).processing?"Creating...":"Create Payment"),9,Pe),e("button",{type:"button",onClick:S,class:"bg-red-600 hover:bg-red-700 text-white px-6 py-2 rounded-lg shadow-md transition"}," Close ")])],32)])]),_:1},8,["show"])],64))}};export{$e as default};
